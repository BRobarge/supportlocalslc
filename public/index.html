<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support Local SLC - Find Deals, Support Community</title>
    <link href="/shared/output.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js"
        crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        .swiper-button-next,
        .swiper-button-prev {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.15);
            color: #111827;
            transition: transform 0.1s ease-in-out;
        }

        .swiper-button-next:hover,
        .swiper-button-prev:hover {
            transform: scale(1.1);
        }

        .swiper-button-next:after,
        .swiper-button-prev:after {
            font-size: 16px;
            font-weight: 900;
        }

        .swiper-button-disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .hero-bg {
            background-image: url('https://storage.googleapis.com/msgsndr/ZPvezSzdrR59azHbDrVt/media/687154c0f85f420c26bbfd37.jpeg');
            background-size: cover;
            background-position: center;
        }
        
        .object-left-center {
            object-position: left center;
        }
        
        /* Add these inside your existing <style> block in the <head> */
        .swiper-button-next,
        .swiper-button-prev {
            display: none !important;
        }

        
    </style>
</head>

<body class="bg-white font-sans">

    <!-- =================================================================== -->
    <!-- --- HEADER / NAVIGATION --- -->
    <!-- =================================================================== -->
    <header class="bg-white shadow-md sticky top-0 z-40">
        <div class="container mx-auto px-6 py-3">
            <div class="flex justify-between items-center">
                <!-- Logo -->
                <a href="/" class="flex-shrink-0">
                    <img class="h-12 w-auto"
                        src="https://kozlfywdsqjndcsibgtw.supabase.co/storage/v1/object/public/business-logos/Site%20Assets/Top%20Logo.png"
                        alt="SupportLocalSLC Logo">
                </a>
    
                <!-- Desktop Navigation -->
                <nav id="desktop-nav" class="hidden lg:flex items-center space-x-8">
                    <!-- Directory Dropdown -->
                    <div class="relative dropdown">
                        <a href="#" class="dropdown-toggle text-gray-600 hover:text-blue-600 font-semibold"
                            data-toggle="dropdown">
                            Directory <i class="fas fa-chevron-down text-xs ml-1"></i>
                        </a>
                        <div class="dropdown-menu hidden absolute mt-2 w-48 bg-white rounded-lg shadow-xl py-2">
                            <a href="/sandy/index.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-50">Sandy</a>
                            <a href="#" class="block px-4 py-2 text-gray-400 cursor-not-allowed">Draper (Soon )</a>
                        </div>
                    </div>
                    <!-- Offers Dropdown -->
                    <div class="relative dropdown">
                        <a href="#" class="dropdown-toggle text-gray-600 hover:text-blue-600 font-semibold"
                            data-toggle="dropdown">
                            Offers <i class="fas fa-chevron-down text-xs ml-1"></i>
                        </a>
                        <div class="dropdown-menu hidden absolute mt-2 w-48 bg-white rounded-lg shadow-xl py-2">
                            <a href="/sandy/index.html?filter=offers"
                                class="block px-4 py-2 text-gray-700 hover:bg-blue-50">Sandy Offers</a>
                            <a href="#" class="block px-4 py-2 text-gray-400 cursor-not-allowed">Draper Offers (Soon)</a>
                        </div>
                    </div>
                    <a href="#" class="text-gray-600 hover:text-blue-600 font-semibold">For Business Owners</a>
                </nav>
    
                <!-- Login/Dashboard Button (Desktop) -->
                <div class="hidden lg:block">
                    <a id="auth-link" href="/login.html"
                        class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700">Login</a>
                </div>
    
                <!-- Mobile Menu Button (Hamburger) -->
                <div class="lg:hidden">
                    <button id="mobile-menu-btn" class="text-gray-600 hover:text-gray-800 focus:outline-none">
                        <i class="fas fa-bars text-2xl"></i>
                    </button>
                </div>
            </div>
    
            <!-- Mobile Menu (Hidden by default) -->
            <nav id="mobile-menu" class="lg:hidden hidden mt-4">
                <!-- Directory Dropdown (Mobile) -->
                <div class="dropdown">
                    <a href="#" class="dropdown-toggle block py-2 text-gray-700 font-semibold"
                        data-toggle="dropdown">Directory <i class="fas fa-chevron-down text-xs ml-1"></i></a>
                    <div class="dropdown-menu hidden pl-4">
                        <a href="/sandy/index.html" class="block py-2 text-gray-600">Sandy</a>
                        <a href="#" class="block py-2 text-gray-400 cursor-not-allowed">Draper (Soon)</a>
                    </div>
                </div>
                <!-- Offers Dropdown (Mobile) -->
                <div class="dropdown">
                    <a href="#" class="dropdown-toggle block py-2 text-gray-700 font-semibold" data-toggle="dropdown">Offers
                        <i class="fas fa-chevron-down text-xs ml-1"></i></a>
                    <div class="dropdown-menu hidden pl-4">
                        <a href="/sandy/index.html?filter=offers" class="block py-2 text-gray-600">Sandy Offers</a>
                        <a href="#" class="block py-2 text-gray-400 cursor-not-allowed">Draper Offers (Soon)</a>
                    </div>
                </div>
                <a href="#" class="block py-2 text-gray-700 font-semibold">For Business Owners</a>
                <hr class="my-2">
                <a id="mobile-auth-link" href="/login.html" class="block py-2 text-gray-700 font-semibold">Login</a>
            </nav>
        </div>
    </header>


    <main>
        <!-- Hero Section -->
        <section id="hero-section" class="relative text-white bg-cover bg-[center_30%] bg-fixed">
        
            <!-- The gradient overlay is a simple, single div -->
            <div class="absolute inset-0 bg-gradient-to-t from-blue-900/80 via-blue-900/60 to-blue-900/30"></div>
        
            <!-- The content is positioned on top -->
            <div
                class="relative z-10 container mx-auto px-6 py-24 text-center flex flex-col items-center justify-center min-h-[50vh]">
                <h1 class="text-4xl md:text-6xl font-extrabold leading-tight">Discover Their Story.
                    Support Their Dream.</h1>
                <p class="mt-4 text-lg text-white max-w-3xl mx-auto">Go beyond the storefront. Connect with the passionate
                    local owners that make our community unique, and enjoy exclusive offers as a thank you for your support.</p>
            </div>
        </section>

        <!-- =================================================================== -->
        <!-- --- Discover Your City Section --- -->
        <!-- =================================================================== -->
        <!-- FIX: Reduced vertical padding from py-12 to py-8 -->
        <section id="city-selector" class="bg-white py-8">
            <div class="container mx-auto px-6 text-center">
                <h2 class="text-3xl font-bold text-gray-800">Discover Your City</h2>
                <p class="mt-2 text-gray-600">Select a community to start exploring local businesses and offers.</p>
        
                <div class="mt-8 flex justify-center">
                    <!-- 
                        FIX: Using `items-baseline` to align the text content of each button.
                        The `min-h-[72px]` on the container ensures there's room for the badge.
                    -->
                    <div class="flex items-baseline space-x-4 overflow-x-auto pb-4 -mx-6 px-6 min-h-[72px]">
        
                        <!-- Active City Link -->
                        <!-- FIX: Added `pt-3` to give it the same invisible top space as the others -->
                        <div class="flex-shrink-0 pt-3">
                            <a href="/sandy/index.html"
                                class="block px-8 py-4 bg-blue-600 text-white font-bold text-lg rounded-lg shadow-md hover:bg-blue-700 transition-transform hover:scale-105">
                                Sandy
                            </a>
                        </div>
        
                        <!-- Coming Soon City -->
                        <!-- FIX: Using `pt-3 pr-3` for consistent spacing -->
                        <div class="relative flex-shrink-0 pt-3 pr-3">
                            <button disabled
                                class="px-8 py-4 bg-gray-300 text-gray-500 font-bold text-lg rounded-lg cursor-not-allowed">Draper</button>
                            <span
                                class="absolute top-0 right-0 bg-yellow-400 text-yellow-900 text-xs font-bold px-2 py-1 rounded-full transform rotate-12">SOON</span>
                        </div>
        
                        <div class="relative flex-shrink-0 pt-3 pr-3">
                            <button disabled
                                class="px-8 py-4 bg-gray-300 text-gray-500 font-bold text-lg rounded-lg cursor-not-allowed">Riverton</button>
                            <span
                                class="absolute top-0 right-0 bg-yellow-400 text-yellow-900 text-xs font-bold px-2 py-1 rounded-full transform rotate-12">SOON</span>
                        </div>
        
                        <div class="relative flex-shrink-0 pt-3 pr-3">
                            <button disabled
                                class="px-8 py-4 bg-gray-300 text-gray-500 font-bold text-lg rounded-lg cursor-not-allowed">South
                                Jordan</button>
                            <span
                                class="absolute top-0 right-0 bg-yellow-400 text-yellow-900 text-xs font-bold px-2 py-1 rounded-full transform rotate-12">SOON</span>
                        </div>
        
                        <div class="relative flex-shrink-0 pt-3 pr-3">
                            <button disabled
                                class="px-8 py-4 bg-gray-300 text-gray-500 font-bold text-lg rounded-lg cursor-not-allowed">Midvale</button>
                            <span
                                class="absolute top-0 right-0 bg-yellow-400 text-yellow-900 text-xs font-bold px-2 py-1 rounded-full transform rotate-12">SOON</span>
                        </div>
        
                    </div>
                </div>
            </div>
        </section>







        <!-- =================================================================== -->
        <!-- --- FIX: SECTIONS ARE NOW IN THE CORRECT ORDER AND HAVE CORRECT BGs --- -->
        <!-- =================================================================== -->
    
        <!-- Featured Listings Carousel -->
        <section class="py-16 bg-white">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">Featured Businesses</h2>
                <div class="swiper" id="featured-listings-swiper">
                    <div class="swiper-wrapper pb-4" id="featured-listings-container"></div>
                    <div class="swiper-button-next"></div>
                    <div class="swiper-button-prev"></div>
                </div>
            </div>
        </section>
    
        <!-- "For Business Owners" CTA -->
        <section id="for-business" class="relative bg-white py-20 lg:py-24">
        
            <!-- Full-width Background Image -->
            <div class="absolute inset-0 z-0">
                <img class="w-full h-full object-cover object-center"
                    src="https://kozlfywdsqjndcsibgtw.supabase.co/storage/v1/object/public/business-logos/Site%20Assets/two-women-ready-to-serve-behind-the-counter-at-a-c-2024-10-19-13-01-44-utc.jpg"
                    alt="Local business owners ready to serve customers">
            </div>
        
            <!-- Dark Overlay for Readability -->
            <div class="absolute inset-0 bg-black bg-opacity-50"></div>
        
            <!-- Centering Container for the Content -->
            <div class="relative z-10 container mx-auto px-6 flex items-center min-h-[360px]">
        
                <!-- FIX: This div now has ml-auto to push it to the right -->
                <div class="w-full max-w-xl lg:w-1/2 lg:ml-auto">
                    <div class="bg-white/95 backdrop-blur-sm p-8 md:p-12 rounded-2xl shadow-2xl">
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-900 text-center lg:text-left">Do you own a local
                            business?</h2>
                        <p class="mt-4 text-lg text-gray-600 text-center lg:text-left">Get discovered by your community. It's
                            free to get started.</p>
                        <div class="mt-8 text-center lg:text-left">
                            <a href="/dashboard.html"
                                class="inline-block bg-blue-600 text-white font-bold py-3 px-10 rounded-lg hover:bg-blue-700 transition-transform hover:scale-105 text-lg">
                                Add Your Business
                            </a>
                        </div>
                    </div>
                </div>
        
            </div>
        </section>





    
        <!-- Latest Offers Carousel -->
        <section id="offers" class="py-16 bg-white">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">Latest Offers</h2>
                <div class="swiper" id="latest-offers-swiper">
                    <div class="swiper-wrapper pb-4" id="latest-offers-container"></div>
                    <div class="swiper-button-next"></div>
                    <div class="swiper-button-prev"></div>
                </div>
            </div>
        </section>
    
    </main>


    <footer class="bg-gray-800 text-gray-400">
        <div class="container mx-auto px-6 py-16">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-12">
                <div class="md:col-span-1"><img
                        src="https://kozlfywdsqjndcsibgtw.supabase.co/storage/v1/object/public/business-logos/Site%20Assets/Top%20Logo.png"
                        alt="SupportLocalSLC Logo" class="h-10 mb-4">
                    <p class="text-sm">Your guide to the best local spots in Salt Lake County.</p>
                </div>
                <div class="md:col-span-3 grid grid-cols-2 md:grid-cols-3 gap-8">
                    <div>
                        <h4 class="font-semibold text-white mb-4">Navigate</h4>
                        <ul class="space-y-3 text-sm">
                            <li><a href="#" class="hover:text-white">Home</a></li>
                            <li><a href="/sandy/index.html" class="hover:text-white">Directory</a></li>
                            <li><a href="#for-business" class="hover:text-white">For Business Owners</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold text-white mb-4">Legal</h4>
                        <ul class="space-y-3 text-sm">
                            <li><a href="/terms.html" class="hover:text-white">Terms of Service</a></li>
                            <li><a href="/privacy.html" class="hover:text-white">Privacy Policy</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold text-white mb-4">Connect</h4>
                        <div class="flex space-x-4"><a href="#" class="text-xl hover:text-white"><i
                                    class="fab fa-facebook-f"></i></a><a href="#" class="text-xl hover:text-white"><i
                                    class="fab fa-instagram"></i></a></div>
                    </div>
                </div>
            </div>
            <div class="mt-12 border-t border-gray-700 pt-8 text-center text-sm">
                <p>&copy; 2025 SupportLocalSLC. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <script type="module">
        const supabaseUrl = 'https://kozlfywdsqjndcsibgtw.supabase.co';
        const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtvemxmeXdkc3FqbmRjc2liZ3R3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIyNTk0NzEsImV4cCI6MjA2NzgzNTQ3MX0.Xb0nRQIVhpW_7uBcwfIuvGZmyPMGzJq6k-6fdgfF3kw';
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseAnonKey);

        // FIX: Corrected Swiper initialization
        function initSwiper(selector) {
                new Swiper(selector, {
                    // How many slides to show at once
                    slidesPerView: 2.2, // Show 2.2 slides on mobile
                    spaceBetween: 16,   // Space between slides

                    // Responsive breakpoints
                    breakpoints: {
                        // when window width is >= 640px (sm)
                        640: {
                            slidesPerView: 3,
                            spaceBetween: 20
                        },
                        // when window width is >= 1024px (lg)
                        1024: {
                            slidesPerView: 4,
                            spaceBetween: 24
                        }
                    },

                    // --- THIS IS THE FIX ---
                    // Disable the navigation arrows
                    navigation: false,

                    // Enable the scrollbar
                    scrollbar: {
                        el: '.swiper-scrollbar',
                        hide: false, // Make scrollbar always visible
                        draggable: true,
                    },
                });
            }

        // Add this new function inside your <script type="module">
            // Replace your existing setupDynamicHero function with this one
                function setupDynamicHero() {
                        const heroImages = [
                            'https://kozlfywdsqjndcsibgtw.supabase.co/storage/v1/object/public/business-logos/Site%20Assets/portrait-of-one-happy-young-hispanic-waiter-standi-2025-04-06-11-04-22-utc.jpg',
                            'https://kozlfywdsqjndcsibgtw.supabase.co/storage/v1/object/public/business-logos/Site%20Assets/a-female-hairdresser-portrait-looking-confidence-2025-01-08-09-13-45-utc.jpg',
                            'https://kozlfywdsqjndcsibgtw.supabase.co/storage/v1/object/public/business-logos/Site%20Assets/beautiful-young-couple-cooking-healthy-food-togeth-2025-03-16-03-18-24-utc.jpg',
                            'https://kozlfywdsqjndcsibgtw.supabase.co/storage/v1/object/public/business-logos/Site%20Assets/family-portrait-of-senior-craftsman-with-daughter-2025-04-03-21-55-11-utc.jpg',
                            'https://kozlfywdsqjndcsibgtw.supabase.co/storage/v1/object/public/business-logos/Site%20Assets/man-and-woman-in-the-pottery-shop-2025-03-13-05-42-26-utc.jpg',
                            'https://kozlfywdsqjndcsibgtw.supabase.co/storage/v1/object/public/business-logos/Site%20Assets/portrait-of-male-and-female-coffee-shop-owners-sta-2024-10-22-05-35-40-utc.jpg',
                            'https://kozlfywdsqjndcsibgtw.supabase.co/storage/v1/object/public/business-logos/Site%20Assets/portrait-of-two-women-starting-new-coffee-shop-or-2024-10-21-02-52-46-utc.jpg',
                            'https://kozlfywdsqjndcsibgtw.supabase.co/storage/v1/object/public/business-logos/Site%20Assets/were-the-best-barbers-in-the-town-2025-04-06-08-12-55-utc.jpg',
                            'https://kozlfywdsqjndcsibgtw.supabase.co/storage/v1/object/public/business-logos/Site%20Assets/young-pretty-dark-haired-asian-woman-owning-cafete-2024-10-17-16-30-29-utc.jpg',
                        ];

                        // Re-enable randomization to make the page feel fresh
                        const randomIndex = Math.floor(Math.random() * heroImages.length);
                        const selectedImage = heroImages[randomIndex];

                        // Target the main <section> element
                        const heroSection = document.getElementById('hero-section');

                        if (heroSection) {
                            // Set the background image style directly on the section
                            heroSection.style.backgroundImage = `url('${selectedImage}')`;
                        }
                    }






        // Replace your entire loadFeaturedListings function with this one.
            async function loadFeaturedListings() {
                const container = document.getElementById('featured-listings-container');
                container.innerHTML = '<p class="text-gray-400">Loading featured businesses...</p>';
                const { data, error } = await supabaseClient.rpc('get_random_pro_businesses', { limit_count: 15 });
                if (error || !data || data.length === 0) {
                    container.innerHTML = '<p class="text-gray-400 col-span-full">No featured businesses to show right now.</p>';
                    return;
                }

                // --- THIS IS THE CORRECTED LINE ---
                container.innerHTML = data.map(biz =>
                    `<div class="swiper-slide">
                        <a href="/${biz.territory}/business.html?id=${biz.id}" class="block bg-white rounded-xl shadow-md overflow-hidden group border border-gray-200 hover:shadow-lg hover:border-blue-500 transition-all duration-300">
                            <div class="h-48 bg-gray-50 flex items-center justify-center overflow-hidden">
                                <!-- FIX: Changed object-cover to object-contain and added p-2 -->
                                <img src="${biz.logo_url || 'https://placehold.co/400x300/EEE/31343C?text=Logo'}" 
                                    alt="${biz.name} Logo" 
                                    class="w-full h-full object-contain p-2 group-hover:scale-105 transition-transform duration-300">
                            </div>
                            <div class="p-4">
                                <h3 class="font-bold text-lg truncate text-gray-800">${biz.name}</h3>
                                <p class="text-sm text-gray-600 truncate">${biz.tagline || '&nbsp;'}</p>
                            </div>
                        </a>
                    </div>`
                ).join('');
                // --- END OF CORRECTION ---

                initSwiper('#featured-listings-swiper');
            }


        async function loadLatestOffers() {
            const container = document.getElementById('latest-offers-container');
            container.innerHTML = '<p class="text-gray-400">Loading latest offers...</p>';
            // FIX: Using the new random offers function
            const { data, error } = await supabaseClient.rpc('get_random_offers', { limit_count: 10 });
            if (error || !data || data.length === 0) { container.innerHTML = '<p class="text-gray-400 col-span-full">No special offers available right now.</p>'; return; }
            container.innerHTML = data.map(offer => `<div class="swiper-slide h-auto"><a href="/${offer.business_territory}/business.html?id=${offer.business_id}" class="block bg-white rounded-xl shadow-md h-full group border border-gray-700 hover:shadow-lg hover:border-blue-500 transition-all duration-300 p-4 flex flex-col"><div class="flex items-center mb-4"><img src="${offer.business_logo_url || 'https://placehold.co/100/EEE/31343C?text=Logo'}" alt="${offer.business_name} Logo" class="w-12 h-12 rounded-full object-cover mr-4 border-2 border-white flex-shrink-0"><p class="font-semibold text-gray-800 flex-grow truncate">${offer.business_name}</p></div><div class="flex-grow flex flex-col"><h3 class="font-bold text-lg text-gray-900 group-hover:text-blue-800 transition-colors">${offer.title}</h3><p class="text-sm text-gray-600 mt-2 line-clamp-3">${offer.description}</p></div></a></div>`).join('');
            initSwiper('#latest-offers-swiper');
        }

        // Replace your entire updateNavAuth function with this one
            // Replace your entire updateNavAuth function with this one.
                function updateNavAuth() {
                    // --- Part 1: Handle Login/Dashboard Button State (No changes needed) ---
                    const authLink = document.getElementById('auth-link');
                    const mobileAuthLink = document.getElementById('mobile-auth-link');
                    const isLoggedIn = sessionStorage.getItem('supabase_session');

                    if (isLoggedIn) {
                        authLink.href = '/dashboard.html'; authLink.textContent = 'Dashboard';
                        mobileAuthLink.href = '/dashboard.html'; mobileAuthLink.textContent = 'Dashboard';
                    } else {
                        authLink.href = '/login.html'; authLink.textContent = 'Login';
                        mobileAuthLink.href = '/login.html'; mobileAuthLink.textContent = 'Login';
                    }

                    // --- Part 2: The Corrected Dropdown Logic ---
                    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
                    const mobileMenu = document.getElementById('mobile-menu');

                    // Toggle the main mobile menu visibility
                    mobileMenuBtn.addEventListener('click', () => {
                        mobileMenu.classList.toggle('hidden');
                    });

                    // Use Event Delegation for all dropdowns (Desktop and Mobile)
                    document.addEventListener('click', (e) => {
                        const isDropdownToggle = e.target.matches('[data-toggle="dropdown"]');

                        // If the click is not on a dropdown toggle, close all dropdowns
                        if (!isDropdownToggle && e.target.closest('.dropdown') === null) {
                            document.querySelectorAll('.dropdown-menu').forEach(menu => menu.classList.add('hidden'));
                            return;
                        }

                        // If it IS a dropdown toggle, handle it
                        if (isDropdownToggle) {
                            e.preventDefault();
                            const dropdownMenu = e.target.nextElementSibling;
                            dropdownMenu.classList.toggle('hidden');
                        }
                    });
                }




        document.addEventListener('DOMContentLoaded', () => {
            setupDynamicHero();
            loadFeaturedListings();
            loadLatestOffers();
            updateNavAuth();
        });
    </script>
</body>

</html>